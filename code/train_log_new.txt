=== 中英翻译模型训练 (mBART) ===
✓ 环境变量设置完成
🚀 加载数据集...
✓ 训练集加载完成，耗时: 1.88 秒
✓ 数据集分割完成
训练集大小: 495000
测试集大小: 5000

==================================================
mBART模型规模定律实验
==================================================

🔄 训练数据集大小: 1.0%

==================================================
训练mBART模型
==================================================
🔧 初始化mBART模型: facebook/mbart-large-50
{"timestamp":"2025-07-06T13:11:14.192000Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.192102Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 1.736489859s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.196785Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.196836Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 1.74643118s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.198489Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.198525Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 240.262372ms before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.198552Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.198600Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.198610Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 1.902543634s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.198623Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 2.507656005s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.198705Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.198758Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.198812Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 736.701823ms before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.199073Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.199247Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 1.923577895s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.199319Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 417.002057ms before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.199772Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.199812Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 2.849819181s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.199826Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.199858Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 1.690162808s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.199904Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.199943Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 1.132374809s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.199996Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.200007Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.200027Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 2.649179743s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.200037Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 303.313675ms before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.200062Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.200113Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 1.008767295s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.200863Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:14.200901Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 814.700238ms before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:14.308608Z","level":"WARN","fields":{"message":"Reqwest(reqwest::Error { kind: Request, source: hyper_util::client::legacy::Error(SendRequest, hyper::Error(IncompleteMessage)) }). Retrying..."},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":242}
{"timestamp":"2025-07-06T13:11:14.308737Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 2.295572401s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:15.188741Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:15.188826Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 802.548962ms before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:15.192276Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:15.192344Z","level":"WARN","fields":{"message":"Retry attempt #0. Sleeping 2.478475771s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
{"timestamp":"2025-07-06T13:11:15.604994Z","level":"WARN","fields":{"message":"Status Code: 503. Retrying...","request_id":""},"filename":"/home/runner/work/xet-core/xet-core/cas_client/src/http_client.rs","line_number":236}
{"timestamp":"2025-07-06T13:11:15.605067Z","level":"WARN","fields":{"message":"Retry attempt #1. Sleeping 1.18714083s before the next attempt"},"filename":"/root/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/reqwest-retry-0.7.0/src/middleware.rs","line_number":171}
✓ mBART模型初始化完成
词汇表大小: 250054
源语言: zh_CN
目标语言: en_XX
🔄 预处理数据...
Tokenizing for mBART:   0%|          | 0/495000 [00:00<?, ? examples/s]/root/miniconda3/lib/python3.12/site-packages/transformers/tokenization_utils_base.py:3951: UserWarning: `as_target_tokenizer` is deprecated and will be removed in v5 of Transformers. You can tokenize your labels by using the argument `text_target` of the regular `__call__` method (either in the same call as your input texts if you use the same keyword arguments, or in a separate call.
  warnings.warn(
Tokenizing for mBART:   0%|          | 1000/495000 [00:00<01:16, 6489.97 examples/s]Tokenizing for mBART:   1%|          | 3000/495000 [00:00<00:47, 10279.08 examples/s]Tokenizing for mBART:   1%|          | 5000/495000 [00:00<00:39, 12543.39 examples/s]Tokenizing for mBART:   1%|▏         | 7000/495000 [00:00<00:35, 13762.70 examples/s]Tokenizing for mBART:   2%|▏         | 9000/495000 [00:00<00:32, 14855.86 examples/s]Tokenizing for mBART:   2%|▏         | 11000/495000 [00:00<00:31, 15483.84 examples/s]Tokenizing for mBART:   3%|▎         | 13000/495000 [00:00<00:29, 16070.73 examples/s]Tokenizing for mBART:   3%|▎         | 15000/495000 [00:01<00:29, 16365.43 examples/s]Tokenizing for mBART:   3%|▎         | 17000/495000 [00:01<00:28, 16599.84 examples/s]Tokenizing for mBART:   4%|▍         | 19000/495000 [00:01<00:28, 16765.85 examples/s]Tokenizing for mBART:   4%|▍         | 21000/495000 [00:01<00:47, 10054.91 examples/s]Tokenizing for mBART:   5%|▍         | 23000/495000 [00:01<00:41, 11415.84 examples/s]Tokenizing for mBART:   5%|▌         | 25000/495000 [00:01<00:36, 12727.05 examples/s]Tokenizing for mBART:   5%|▌         | 27000/495000 [00:01<00:33, 13872.90 examples/s]Tokenizing for mBART:   6%|▌         | 29000/495000 [00:02<00:31, 14691.75 examples/s]Tokenizing for mBART:   6%|▋         | 31000/495000 [00:02<00:30, 15370.42 examples/s]Tokenizing for mBART:   7%|▋         | 33000/495000 [00:02<00:29, 15726.68 examples/s]Tokenizing for mBART:   7%|▋         | 35000/495000 [00:02<00:28, 15978.12 examples/s]Tokenizing for mBART:   7%|▋         | 37000/495000 [00:02<00:42, 10772.96 examples/s]Tokenizing for mBART:   8%|▊         | 39000/495000 [00:02<00:37, 12133.99 examples/s]Tokenizing for mBART:   8%|▊         | 41000/495000 [00:03<00:34, 13307.93 examples/s]Tokenizing for mBART:   9%|▊         | 43000/495000 [00:03<00:31, 14222.91 examples/s]Tokenizing for mBART:   9%|▉         | 45000/495000 [00:03<00:30, 14881.48 examples/s]Tokenizing for mBART:   9%|▉         | 47000/495000 [00:03<00:29, 15315.28 examples/s]Tokenizing for mBART:  10%|▉         | 49000/495000 [00:03<00:28, 15400.70 examples/s]Tokenizing for mBART:  10%|█         | 51000/495000 [00:03<00:28, 15574.65 examples/s]Tokenizing for mBART:  11%|█         | 53000/495000 [00:03<00:42, 10426.71 examples/s]Tokenizing for mBART:  11%|█         | 55000/495000 [00:04<00:37, 11608.54 examples/s]Tokenizing for mBART:  12%|█▏        | 57000/495000 [00:04<00:34, 12548.44 examples/s]Tokenizing for mBART:  12%|█▏        | 59000/495000 [00:04<00:32, 13406.02 examples/s]Tokenizing for mBART:  12%|█▏        | 61000/495000 [00:04<00:30, 14081.48 examples/s]Tokenizing for mBART:  13%|█▎        | 63000/495000 [00:04<00:29, 14535.91 examples/s]Tokenizing for mBART:  13%|█▎        | 65000/495000 [00:04<00:29, 14820.38 examples/s]Tokenizing for mBART:  14%|█▎        | 67000/495000 [00:04<00:28, 15075.98 examples/s]Tokenizing for mBART:  14%|█▍        | 69000/495000 [00:05<00:40, 10562.21 examples/s]Tokenizing for mBART:  14%|█▍        | 71000/495000 [00:05<00:36, 11606.33 examples/s]Tokenizing for mBART:  15%|█▍        | 73000/495000 [00:05<00:33, 12598.09 examples/s]Tokenizing for mBART:  15%|█▌        | 75000/495000 [00:05<00:30, 13641.03 examples/s]Tokenizing for mBART:  16%|█▌        | 77000/495000 [00:05<00:28, 14530.91 examples/s]Tokenizing for mBART:  16%|█▌        | 79000/495000 [00:05<00:27, 15228.24 examples/s]Tokenizing for mBART:  16%|█▋        | 81000/495000 [00:05<00:27, 15028.87 examples/s]Tokenizing for mBART:  17%|█▋        | 83000/495000 [00:06<00:26, 15583.00 examples/s]Tokenizing for mBART:  17%|█▋        | 85000/495000 [00:06<00:26, 15714.30 examples/s]Tokenizing for mBART:  18%|█▊        | 87000/495000 [00:06<00:37, 10821.40 examples/s]Tokenizing for mBART:  18%|█▊        | 89000/495000 [00:06<00:33, 12115.12 examples/s]Tokenizing for mBART:  18%|█▊        | 91000/495000 [00:06<00:30, 13163.18 examples/s]Tokenizing for mBART:  19%|█▉        | 93000/495000 [00:06<00:28, 13938.59 examples/s]Tokenizing for mBART:  19%|█▉        | 95000/495000 [00:06<00:27, 14768.33 examples/s]Tokenizing for mBART:  20%|█▉        | 97000/495000 [00:07<00:25, 15386.65 examples/s]Tokenizing for mBART:  20%|██        | 99000/495000 [00:07<00:24, 15863.94 examples/s]Tokenizing for mBART:  20%|██        | 101000/495000 [00:07<00:24, 16301.15 examples/s]Tokenizing for mBART:  21%|██        | 103000/495000 [00:07<00:35, 11047.17 examples/s]Tokenizing for mBART:  21%|██        | 105000/495000 [00:07<00:31, 12225.06 examples/s]Tokenizing for mBART:  22%|██▏       | 107000/495000 [00:07<00:29, 13309.27 examples/s]Tokenizing for mBART:  22%|██▏       | 109000/495000 [00:08<00:27, 14189.80 examples/s]Tokenizing for mBART:  22%|██▏       | 111000/495000 [00:08<00:26, 14659.57 examples/s]Tokenizing for mBART:  23%|██▎       | 113000/495000 [00:08<00:25, 15146.97 examples/s]Tokenizing for mBART:  23%|██▎       | 115000/495000 [00:08<00:24, 15546.21 examples/s]Tokenizing for mBART:  24%|██▎       | 117000/495000 [00:08<00:23, 15995.75 examples/s]Tokenizing for mBART:  24%|██▍       | 119000/495000 [00:08<00:34, 10910.55 examples/s]Tokenizing for mBART:  24%|██▍       | 121000/495000 [00:08<00:30, 12190.21 examples/s]Tokenizing for mBART:  25%|██▍       | 123000/495000 [00:09<00:27, 13412.69 examples/s]Tokenizing for mBART:  25%|██▌       | 125000/495000 [00:09<00:25, 14394.32 examples/s]Tokenizing for mBART:  26%|██▌       | 127000/495000 [00:09<00:24, 15181.43 examples/s]Tokenizing for mBART:  26%|██▌       | 129000/495000 [00:09<00:22, 15942.16 examples/s]Tokenizing for mBART:  26%|██▋       | 131000/495000 [00:09<00:22, 16173.06 examples/s]Tokenizing for mBART:  27%|██▋       | 133000/495000 [00:09<00:21, 16459.70 examples/s]Tokenizing for mBART:  27%|██▋       | 135000/495000 [00:09<00:21, 16690.77 examples/s]Tokenizing for mBART:  28%|██▊       | 137000/495000 [00:10<00:35, 10076.58 examples/s]Tokenizing for mBART:  28%|██▊       | 139000/495000 [00:10<00:30, 11581.68 examples/s]Tokenizing for mBART:  28%|██▊       | 141000/495000 [00:10<00:27, 12813.45 examples/s]Tokenizing for mBART:  29%|██▉       | 143000/495000 [00:10<00:25, 13932.21 examples/s]Tokenizing for mBART:  29%|██▉       | 145000/495000 [00:10<00:23, 14859.14 examples/s]Tokenizing for mBART:  30%|██▉       | 147000/495000 [00:10<00:22, 15458.19 examples/s]Tokenizing for mBART:  30%|███       | 149000/495000 [00:10<00:21, 15963.72 examples/s]Tokenizing for mBART:  31%|███       | 151000/495000 [00:10<00:21, 16366.81 examples/s]Tokenizing for mBART:  31%|███       | 153000/495000 [00:11<00:30, 11204.47 examples/s]Tokenizing for mBART:  31%|███▏      | 155000/495000 [00:11<00:27, 12575.68 examples/s]Tokenizing for mBART:  32%|███▏      | 157000/495000 [00:11<00:24, 13695.31 examples/s]Tokenizing for mBART:  32%|███▏      | 159000/495000 [00:11<00:22, 14703.53 examples/s]Tokenizing for mBART:  33%|███▎      | 161000/495000 [00:11<00:21, 15426.54 examples/s]Tokenizing for mBART:  33%|███▎      | 163000/495000 [00:11<00:20, 15931.84 examples/s]Tokenizing for mBART:  33%|███▎      | 165000/495000 [00:11<00:20, 16334.99 examples/s]Tokenizing for mBART:  34%|███▎      | 167000/495000 [00:12<00:19, 16634.20 examples/s]Tokenizing for mBART:  34%|███▍      | 169000/495000 [00:12<00:19, 16865.50 examples/s]Tokenizing for mBART:  35%|███▍      | 171000/495000 [00:12<00:28, 11205.23 examples/s]Tokenizing for mBART:  35%|███▍      | 173000/495000 [00:12<00:25, 12473.99 examples/s]Tokenizing for mBART:  35%|███▌      | 175000/495000 [00:12<00:23, 13407.88 examples/s]Tokenizing for mBART:  36%|███▌      | 177000/495000 [00:12<00:23, 13803.98 examples/s]Tokenizing for mBART:  36%|███▌      | 179000/495000 [00:12<00:21, 14607.72 examples/s]Tokenizing for mBART:  37%|███▋      | 181000/495000 [00:13<00:20, 15195.40 examples/s]Tokenizing for mBART:  37%|███▋      | 183000/495000 [00:13<00:20, 15072.59 examples/s]Tokenizing for mBART:  37%|███▋      | 185000/495000 [00:13<00:19, 15581.24 examples/s]Tokenizing for mBART:  38%|███▊      | 187000/495000 [00:13<00:30, 10264.66 examples/s]Tokenizing for mBART:  38%|███▊      | 189000/495000 [00:13<00:26, 11598.25 examples/s]Tokenizing for mBART:  39%|███▊      | 191000/495000 [00:13<00:23, 12763.35 examples/s]Tokenizing for mBART:  39%|███▉      | 193000/495000 [00:14<00:21, 13852.42 examples/s]Tokenizing for mBART:  39%|███▉      | 195000/495000 [00:14<00:20, 14798.85 examples/s]Tokenizing for mBART:  40%|███▉      | 197000/495000 [00:14<00:19, 15389.70 examples/s]Tokenizing for mBART:  40%|████      | 199000/495000 [00:14<00:18, 15926.78 examples/s]Tokenizing for mBART:  41%|████      | 201000/495000 [00:14<00:18, 16325.70 examples/s]Tokenizing for mBART:  41%|████      | 203000/495000 [00:14<00:17, 16528.67 examples/s]Tokenizing for mBART:  41%|████▏     | 205000/495000 [00:14<00:25, 11243.65 examples/s]Tokenizing for mBART:  42%|████▏     | 207000/495000 [00:15<00:22, 12572.28 examples/s]Tokenizing for mBART:  42%|████▏     | 209000/495000 [00:15<00:20, 13709.23 examples/s]Tokenizing for mBART:  43%|████▎     | 211000/495000 [00:15<00:19, 14643.96 examples/s]Tokenizing for mBART:  43%|████▎     | 213000/495000 [00:15<00:18, 15289.80 examples/s]Tokenizing for mBART:  43%|████▎     | 215000/495000 [00:15<00:17, 15854.42 examples/s]Tokenizing for mBART:  44%|████▍     | 217000/495000 [00:15<00:17, 16281.86 examples/s]Tokenizing for mBART:  44%|████▍     | 219000/495000 [00:15<00:16, 16742.18 examples/s]Tokenizing for mBART:  45%|████▍     | 221000/495000 [00:16<00:24, 11234.39 examples/s]Tokenizing for mBART:  45%|████▌     | 223000/495000 [00:16<00:21, 12559.10 examples/s]Tokenizing for mBART:  45%|████▌     | 225000/495000 [00:16<00:19, 13632.18 examples/s]Tokenizing for mBART:  46%|████▌     | 227000/495000 [00:16<00:18, 14604.72 examples/s]Tokenizing for mBART:  46%|████▋     | 229000/495000 [00:16<00:17, 15338.79 examples/s]Tokenizing for mBART:  47%|████▋     | 231000/495000 [00:16<00:16, 15839.74 examples/s]Tokenizing for mBART:  47%|████▋     | 233000/495000 [00:16<00:16, 16245.97 examples/s]Tokenizing for mBART:  47%|████▋     | 235000/495000 [00:16<00:15, 16506.17 examples/s]Tokenizing for mBART:  48%|████▊     | 237000/495000 [00:16<00:15, 16812.12 examples/s]Tokenizing for mBART:  48%|████▊     | 239000/495000 [00:17<00:23, 10771.72 examples/s]Tokenizing for mBART:  49%|████▊     | 241000/495000 [00:17<00:21, 12050.82 examples/s]Tokenizing for mBART:  49%|████▉     | 243000/495000 [00:17<00:19, 13237.51 examples/s]Tokenizing for mBART:  49%|████▉     | 245000/495000 [00:17<00:17, 14213.86 examples/s]Tokenizing for mBART:  50%|████▉     | 247000/495000 [00:17<00:16, 15055.81 examples/s]Tokenizing for mBART:  50%|█████     | 249000/495000 [00:17<00:15, 15800.38 examples/s]Tokenizing for mBART:  51%|█████     | 251000/495000 [00:18<00:15, 15492.28 examples/s]Tokenizing for mBART:  51%|█████     | 253000/495000 [00:18<00:15, 15974.94 examples/s]Tokenizing for mBART:  52%|█████▏    | 255000/495000 [00:18<00:21, 11062.71 examples/s]Tokenizing for mBART:  52%|█████▏    | 257000/495000 [00:18<00:19, 12404.57 examples/s]Tokenizing for mBART:  52%|█████▏    | 259000/495000 [00:18<00:17, 13568.54 examples/s]Tokenizing for mBART:  53%|█████▎    | 261000/495000 [00:18<00:16, 14529.26 examples/s]Tokenizing for mBART:  53%|█████▎    | 263000/495000 [00:18<00:15, 15284.09 examples/s]Tokenizing for mBART:  54%|█████▎    | 265000/495000 [00:19<00:14, 15754.93 examples/s]Tokenizing for mBART:  54%|█████▍    | 267000/495000 [00:19<00:14, 16086.50 examples/s]Tokenizing for mBART:  54%|█████▍    | 269000/495000 [00:19<00:13, 16411.17 examples/s]Tokenizing for mBART:  55%|█████▍    | 271000/495000 [00:19<00:13, 16786.67 examples/s]Tokenizing for mBART:  55%|█████▌    | 273000/495000 [00:19<00:19, 11304.19 examples/s]Tokenizing for mBART:  56%|█████▌    | 275000/495000 [00:19<00:17, 12432.29 examples/s]Tokenizing for mBART:  56%|█████▌    | 277000/495000 [00:19<00:16, 13601.33 examples/s]Tokenizing for mBART:  56%|█████▋    | 279000/495000 [00:20<00:14, 14560.21 examples/s]Tokenizing for mBART:  57%|█████▋    | 281000/495000 [00:20<00:13, 15326.63 examples/s]Tokenizing for mBART:  57%|█████▋    | 283000/495000 [00:20<00:13, 15895.71 examples/s]Tokenizing for mBART:  58%|█████▊    | 285000/495000 [00:20<00:13, 16038.64 examples/s]Tokenizing for mBART:  58%|█████▊    | 287000/495000 [00:20<00:12, 16472.28 examples/s]Tokenizing for mBART:  58%|█████▊    | 289000/495000 [00:20<00:18, 11288.48 examples/s]Tokenizing for mBART:  59%|█████▉    | 291000/495000 [00:20<00:16, 12669.85 examples/s]Tokenizing for mBART:  59%|█████▉    | 293000/495000 [00:21<00:14, 13769.66 examples/s]Tokenizing for mBART:  60%|█████▉    | 295000/495000 [00:21<00:13, 14700.65 examples/s]Tokenizing for mBART:  60%|██████    | 297000/495000 [00:21<00:12, 15547.17 examples/s]Tokenizing for mBART:  60%|██████    | 299000/495000 [00:21<00:12, 15927.92 examples/s]Tokenizing for mBART:  61%|██████    | 301000/495000 [00:21<00:11, 16265.68 examples/s]Tokenizing for mBART:  61%|██████    | 303000/495000 [00:21<00:11, 16725.03 examples/s]Tokenizing for mBART:  62%|██████▏   | 305000/495000 [00:21<00:11, 16643.85 examples/s]Tokenizing for mBART:  62%|██████▏   | 307000/495000 [00:22<00:17, 10576.36 examples/s]Tokenizing for mBART:  62%|██████▏   | 309000/495000 [00:22<00:15, 12044.69 examples/s]Tokenizing for mBART:  63%|██████▎   | 311000/495000 [00:22<00:13, 13211.69 examples/s]Tokenizing for mBART:  63%|██████▎   | 313000/495000 [00:22<00:12, 14349.10 examples/s]Tokenizing for mBART:  64%|██████▎   | 315000/495000 [00:22<00:11, 15026.36 examples/s]Tokenizing for mBART:  64%|██████▍   | 317000/495000 [00:22<00:11, 15594.77 examples/s]Tokenizing for mBART:  64%|██████▍   | 319000/495000 [00:22<00:11, 15958.67 examples/s]Tokenizing for mBART:  65%|██████▍   | 321000/495000 [00:22<00:10, 16345.35 examples/s]Tokenizing for mBART:  65%|██████▌   | 323000/495000 [00:23<00:15, 11050.06 examples/s]Tokenizing for mBART:  66%|██████▌   | 325000/495000 [00:23<00:13, 12293.36 examples/s]Tokenizing for mBART:  66%|██████▌   | 327000/495000 [00:23<00:12, 13434.59 examples/s]Tokenizing for mBART:  66%|██████▋   | 329000/495000 [00:23<00:11, 14503.62 examples/s]Tokenizing for mBART:  67%|██████▋   | 331000/495000 [00:23<00:10, 15228.05 examples/s]Tokenizing for mBART:  67%|██████▋   | 333000/495000 [00:23<00:10, 15791.50 examples/s]Tokenizing for mBART:  68%|██████▊   | 335000/495000 [00:23<00:09, 16123.99 examples/s]Tokenizing for mBART:  68%|██████▊   | 337000/495000 [00:24<00:09, 16369.52 examples/s]Tokenizing for mBART:  68%|██████▊   | 339000/495000 [00:24<00:09, 16769.46 examples/s]Tokenizing for mBART:  69%|██████▉   | 341000/495000 [00:24<00:13, 11357.03 examples/s]Tokenizing for mBART:  69%|██████▉   | 343000/495000 [00:24<00:11, 12748.37 examples/s]Tokenizing for mBART:  70%|██████▉   | 345000/495000 [00:24<00:10, 13852.61 examples/s]Tokenizing for mBART:  70%|███████   | 347000/495000 [00:24<00:09, 14865.66 examples/s]Tokenizing for mBART:  71%|███████   | 349000/495000 [00:24<00:09, 15651.20 examples/s]Tokenizing for mBART:  71%|███████   | 351000/495000 [00:25<00:08, 16122.39 examples/s]Tokenizing for mBART:  71%|███████▏  | 353000/495000 [00:25<00:08, 16542.09 examples/s]Tokenizing for mBART:  72%|███████▏  | 355000/495000 [00:25<00:08, 16916.83 examples/s]Tokenizing for mBART:  72%|███████▏  | 357000/495000 [00:25<00:11, 11668.15 examples/s]Tokenizing for mBART:  73%|███████▎  | 359000/495000 [00:25<00:10, 12990.98 examples/s]Tokenizing for mBART:  73%|███████▎  | 361000/495000 [00:25<00:09, 14122.61 examples/s]Tokenizing for mBART:  73%|███████▎  | 363000/495000 [00:25<00:08, 15089.52 examples/s]Tokenizing for mBART:  74%|███████▎  | 365000/495000 [00:26<00:08, 15763.43 examples/s]Tokenizing for mBART:  74%|███████▍  | 367000/495000 [00:26<00:07, 16266.85 examples/s]Tokenizing for mBART:  75%|███████▍  | 369000/495000 [00:26<00:07, 16555.14 examples/s]Tokenizing for mBART:  75%|███████▍  | 371000/495000 [00:26<00:07, 16915.16 examples/s]Tokenizing for mBART:  75%|███████▌  | 373000/495000 [00:26<00:07, 17096.40 examples/s]Tokenizing for mBART:  76%|███████▌  | 375000/495000 [00:26<00:10, 10956.16 examples/s]Tokenizing for mBART:  76%|███████▌  | 377000/495000 [00:26<00:09, 12370.10 examples/s]Tokenizing for mBART:  77%|███████▋  | 379000/495000 [00:27<00:08, 13580.58 examples/s]Tokenizing for mBART:  77%|███████▋  | 381000/495000 [00:27<00:07, 14630.74 examples/s]Tokenizing for mBART:  77%|███████▋  | 383000/495000 [00:27<00:07, 15461.26 examples/s]Tokenizing for mBART:  78%|███████▊  | 385000/495000 [00:27<00:06, 16099.47 examples/s]Tokenizing for mBART:  78%|███████▊  | 387000/495000 [00:27<00:06, 16580.56 examples/s]Tokenizing for mBART:  79%|███████▊  | 389000/495000 [00:27<00:06, 17003.75 examples/s]Tokenizing for mBART:  79%|███████▉  | 391000/495000 [00:27<00:09, 11519.63 examples/s]Tokenizing for mBART:  79%|███████▉  | 393000/495000 [00:27<00:07, 12871.11 examples/s]Tokenizing for mBART:  80%|███████▉  | 395000/495000 [00:28<00:07, 14041.00 examples/s]Tokenizing for mBART:  80%|████████  | 397000/495000 [00:28<00:06, 14462.01 examples/s]Tokenizing for mBART:  81%|████████  | 399000/495000 [00:28<00:06, 14773.25 examples/s]Tokenizing for mBART:  81%|████████  | 401000/495000 [00:28<00:06, 15422.58 examples/s]Tokenizing for mBART:  81%|████████▏ | 403000/495000 [00:28<00:06, 15027.16 examples/s]Tokenizing for mBART:  82%|████████▏ | 405000/495000 [00:28<00:05, 15541.31 examples/s]Tokenizing for mBART:  82%|████████▏ | 407000/495000 [00:28<00:05, 16074.29 examples/s]Tokenizing for mBART:  83%|████████▎ | 409000/495000 [00:29<00:07, 11267.84 examples/s]Tokenizing for mBART:  83%|████████▎ | 411000/495000 [00:29<00:06, 12653.90 examples/s]Tokenizing for mBART:  83%|████████▎ | 413000/495000 [00:29<00:05, 13824.61 examples/s]Tokenizing for mBART:  84%|████████▍ | 415000/495000 [00:29<00:05, 14584.77 examples/s]Tokenizing for mBART:  84%|████████▍ | 417000/495000 [00:29<00:05, 15293.76 examples/s]Tokenizing for mBART:  85%|████████▍ | 419000/495000 [00:29<00:04, 15891.32 examples/s]Tokenizing for mBART:  85%|████████▌ | 421000/495000 [00:29<00:04, 16237.77 examples/s]Tokenizing for mBART:  85%|████████▌ | 423000/495000 [00:29<00:04, 16550.99 examples/s]Tokenizing for mBART:  86%|████████▌ | 425000/495000 [00:30<00:06, 11509.48 examples/s]Tokenizing for mBART:  86%|████████▋ | 427000/495000 [00:30<00:05, 12858.57 examples/s]Tokenizing for mBART:  87%|████████▋ | 429000/495000 [00:30<00:04, 13891.83 examples/s]Tokenizing for mBART:  87%|████████▋ | 431000/495000 [00:30<00:04, 14813.16 examples/s]Tokenizing for mBART:  87%|████████▋ | 433000/495000 [00:30<00:04, 15351.63 examples/s]Tokenizing for mBART:  88%|████████▊ | 435000/495000 [00:30<00:03, 15767.79 examples/s]Tokenizing for mBART:  88%|████████▊ | 437000/495000 [00:30<00:03, 16186.68 examples/s]Tokenizing for mBART:  89%|████████▊ | 439000/495000 [00:31<00:03, 16505.55 examples/s]Tokenizing for mBART:  89%|████████▉ | 441000/495000 [00:31<00:03, 16659.55 examples/s]Tokenizing for mBART:  89%|████████▉ | 443000/495000 [00:31<00:04, 11286.14 examples/s]Tokenizing for mBART:  90%|████████▉ | 445000/495000 [00:31<00:03, 12672.65 examples/s]Tokenizing for mBART:  90%|█████████ | 447000/495000 [00:31<00:03, 13721.92 examples/s]Tokenizing for mBART:  91%|█████████ | 449000/495000 [00:31<00:03, 14521.07 examples/s]Tokenizing for mBART:  91%|█████████ | 451000/495000 [00:31<00:02, 15275.64 examples/s]Tokenizing for mBART:  92%|█████████▏| 453000/495000 [00:32<00:02, 15834.54 examples/s]Tokenizing for mBART:  92%|█████████▏| 455000/495000 [00:32<00:02, 16231.25 examples/s]Tokenizing for mBART:  92%|█████████▏| 457000/495000 [00:32<00:02, 16407.92 examples/s]Tokenizing for mBART:  93%|█████████▎| 459000/495000 [00:32<00:03, 11087.39 examples/s]Tokenizing for mBART:  93%|█████████▎| 461000/495000 [00:32<00:02, 12099.14 examples/s]Tokenizing for mBART:  94%|█████████▎| 463000/495000 [00:32<00:02, 13117.47 examples/s]Tokenizing for mBART:  94%|█████████▍| 465000/495000 [00:33<00:02, 14160.79 examples/s]Tokenizing for mBART:  94%|█████████▍| 467000/495000 [00:33<00:01, 14985.77 examples/s]Tokenizing for mBART:  95%|█████████▍| 469000/495000 [00:33<00:01, 15509.48 examples/s]Tokenizing for mBART:  95%|█████████▌| 471000/495000 [00:33<00:01, 15937.46 examples/s]Tokenizing for mBART:  96%|█████████▌| 473000/495000 [00:33<00:01, 16294.93 examples/s]Tokenizing for mBART:  96%|█████████▌| 475000/495000 [00:33<00:01, 16554.80 examples/s]Tokenizing for mBART:  96%|█████████▋| 477000/495000 [00:33<00:01, 10391.28 examples/s]Tokenizing for mBART:  97%|█████████▋| 479000/495000 [00:34<00:01, 11783.15 examples/s]Tokenizing for mBART:  97%|█████████▋| 481000/495000 [00:34<00:01, 13009.60 examples/s]Tokenizing for mBART:  98%|█████████▊| 483000/495000 [00:34<00:00, 14048.40 examples/s]Tokenizing for mBART:  98%|█████████▊| 485000/495000 [00:34<00:00, 14720.06 examples/s]Tokenizing for mBART:  98%|█████████▊| 487000/495000 [00:34<00:00, 15153.55 examples/s]Tokenizing for mBART:  99%|█████████▉| 489000/495000 [00:34<00:00, 15594.02 examples/s]Tokenizing for mBART:  99%|█████████▉| 491000/495000 [00:34<00:00, 15956.41 examples/s]Tokenizing for mBART: 100%|█████████▉| 493000/495000 [00:35<00:00, 11033.42 examples/s]Tokenizing for mBART: 100%|██████████| 495000/495000 [00:35<00:00, 12361.39 examples/s]Tokenizing for mBART: 100%|██████████| 495000/495000 [00:35<00:00, 14054.16 examples/s]
Tokenizing for mBART:   0%|          | 0/5000 [00:00<?, ? examples/s]Tokenizing for mBART:  40%|████      | 2000/5000 [00:00<00:00, 14217.47 examples/s]Tokenizing for mBART:  80%|████████  | 4000/5000 [00:00<00:00, 15856.66 examples/s]Tokenizing for mBART: 100%|██████████| 5000/5000 [00:00<00:00, 15691.17 examples/s]
💾 缓存预处理数据...
Saving the dataset (0/1 shards):   0%|          | 0/495000 [00:00<?, ? examples/s]Saving the dataset (0/1 shards):  21%|██        | 104000/495000 [00:00<00:00, 836173.79 examples/s]Saving the dataset (0/1 shards):  41%|████      | 201000/495000 [00:00<00:00, 900903.56 examples/s]Saving the dataset (0/1 shards):  62%|██████▏   | 306000/495000 [00:00<00:00, 957472.42 examples/s]Saving the dataset (0/1 shards):  84%|████████▍ | 415000/495000 [00:00<00:00, 1003404.42 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 495000/495000 [00:00<00:00, 1003404.42 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 495000/495000 [00:00<00:00, 538354.13 examples/s] 
Saving the dataset (0/1 shards):   0%|          | 0/5000 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 5000/5000 [00:00<00:00, 621488.86 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 5000/5000 [00:00<00:00, 608752.39 examples/s]
✓ 数据预处理完成
🚀 开始训练mBART模型...
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:02<00:06,  1.05s/it] 38%|███▊      | 3/8 [00:04<00:07,  1.45s/it] 50%|█████     | 4/8 [00:06<00:07,  1.78s/it] 62%|██████▎   | 5/8 [00:08<00:05,  1.94s/it] 75%|███████▌  | 6/8 [00:11<00:04,  2.12s/it] 88%|████████▊ | 7/8 [00:13<00:02,  2.22s/it]100%|██████████| 8/8 [00:15<00:00,  2.13s/it][1] 预测: 过了一会,他咳嗽了几声,把橄榄色的双手合拢在桌面上。
    标签: ['After a few seconds, he coughed and folded his olive-skin hands on the table.']
[2] 预测: 我可以花费一晚上一晚上的时间禁闭在我的公寓里,并且我常常面对几乎没有陪伴的周末。
    标签: ['I could spend evening after evening cooped up in my flat, and I was often faced with weekends that offered little or nothing in the way of company.']
[3] 预测: 中生代中晚期的区域构造热事件是太康-济源古生界区域性高热演化形成的主控因素。
    标签: ['The regional tectonicthermal events in the MidLate Mesozoic were the crucial factors controlling the regional high thermal evolution of the Paleozoic in TaikangJiyuan area.']
[4] 预测: 我们的心没有退后,我们的脚也没有偏离你的路。
    标签: ['Our hearts had not turned back; our feet had not strayed from your path.']
[5] 预测: 他鞭打马,让他走的快点。 他鞭打马,让他走的快点。
    标签: ['He switched his horse to make it go faster .']
100%|██████████| 8/8 [00:15<00:00,  1.95s/it]
🔄 初始评估结果:
{'eval_loss': 8.534534454345703, 'eval_model_preparation_time': 0.0047, 'eval_bleu': 0.0631, 'eval_gen_len': 29.924, 'eval_runtime': 18.9101, 'eval_samples_per_second': 26.441, 'eval_steps_per_second': 0.423}

==================================================
模型推理示例
==================================================
[1] 输入: 过了一会,他咳嗽了几声,把橄榄色的双手合拢在桌面上。
    预测: 过了一会,他咳嗽了几声,把橄榄色的双手合拢在桌面上。
    参考: After a few seconds, he coughed and folded his olive-skin hands on the table.

[2] 输入: 我可以花费一晚上一晚上的时间禁闭在我的公寓里,并且我常常面对几乎没有陪伴的周末。
    预测: 我可以花费一晚上一个晚上的时间禁闭在我的公寓里,并且我常常面对几乎没有陪伴的周末。
    参考: I could spend evening after evening cooped up in my flat, and I was often faced with weekends that offered little or nothing in the way of company.

[3] 输入: 中生代中晚期的区域构造热事件是太康-济源古生界区域性高热演化形成的主控因素。
    预测: 中生代中晚期的区域构造热事件是太康-济源古生界区域性高热演化形成的主控因素。
    参考: The regional tectonicthermal events in the MidLate Mesozoic were the crucial factors controlling the regional high thermal evolution of the Paleozoic in TaikangJiyuan area.

[4] 输入: 我们的心没有退后,我们的脚也没有偏离你的路。
    预测: 我们的心没有退后,我们的脚也没有偏离你的路。。我们没有回头,我们也没有回头。
    参考: Our hearts had not turned back; our feet had not strayed from your path.

[5] 输入: 他鞭打马,让他走的快点。
    预测: 他鞭打马,让他走的快点。 马不停蹄的往前走,他走得越远,越快越好。
    参考: He switched his horse to make it go faster .

  0%|          | 0/234 [00:00<?, ?it/s]  0%|          | 1/234 [00:00<02:05,  1.85it/s]  1%|          | 2/234 [00:00<01:22,  2.80it/s]  1%|▏         | 3/234 [00:00<01:07,  3.42it/s]  2%|▏         | 4/234 [00:01<00:58,  3.94it/s]  2%|▏         | 5/234 [00:01<00:58,  3.93it/s]  3%|▎         | 6/234 [00:01<00:53,  4.30it/s]  3%|▎         | 7/234 [00:01<00:51,  4.39it/s]  3%|▎         | 8/234 [00:02<00:52,  4.27it/s]  4%|▍         | 9/234 [00:02<00:51,  4.40it/s]  4%|▍         | 10/234 [00:02<00:51,  4.39it/s]  5%|▍         | 11/234 [00:02<00:49,  4.50it/s]  5%|▌         | 12/234 [00:02<00:49,  4.48it/s]  6%|▌         | 13/234 [00:03<00:48,  4.51it/s]  6%|▌         | 14/234 [00:03<00:49,  4.40it/s]  6%|▋         | 15/234 [00:03<00:49,  4.47it/s]  7%|▋         | 16/234 [00:03<00:49,  4.38it/s]  7%|▋         | 17/234 [00:04<00:50,  4.33it/s]  8%|▊         | 18/234 [00:04<00:50,  4.31it/s]  8%|▊         | 19/234 [00:04<00:49,  4.34it/s]  9%|▊         | 20/234 [00:04<00:48,  4.41it/s]  9%|▉         | 21/234 [00:05<00:50,  4.25it/s]  9%|▉         | 22/234 [00:05<00:49,  4.32it/s] 10%|▉         | 23/234 [00:05<00:48,  4.33it/s] 10%|█         | 24/234 [00:05<00:48,  4.30it/s] 11%|█         | 25/234 [00:05<00:47,  4.38it/s] 11%|█         | 26/234 [00:06<00:47,  4.37it/s] 12%|█▏        | 27/234 [00:06<00:46,  4.41it/s] 12%|█▏        | 28/234 [00:06<00:46,  4.45it/s] 12%|█▏        | 29/234 [00:06<00:46,  4.45it/s] 13%|█▎        | 30/234 [00:07<00:46,  4.39it/s] 13%|█▎        | 31/234 [00:07<00:47,  4.30it/s] 14%|█▎        | 32/234 [00:07<00:47,  4.30it/s] 14%|█▍        | 33/234 [00:07<00:46,  4.31it/s] 15%|█▍        | 34/234 [00:08<00:45,  4.36it/s] 15%|█▍        | 35/234 [00:08<00:47,  4.15it/s] 15%|█▌        | 36/234 [00:08<00:47,  4.17it/s] 16%|█▌        | 37/234 [00:08<00:45,  4.30it/s] 16%|█▌        | 38/234 [00:08<00:44,  4.36it/s] 17%|█▋        | 39/234 [00:09<00:44,  4.37it/s] 17%|█▋        | 40/234 [00:09<00:44,  4.41it/s] 18%|█▊        | 41/234 [00:09<00:43,  4.40it/s] 18%|█▊        | 42/234 [00:09<00:43,  4.38it/s] 18%|█▊        | 43/234 [00:10<01:09,  2.73it/s] 19%|█▉        | 44/234 [00:10<01:01,  3.10it/s] 19%|█▉        | 45/234 [00:11<00:56,  3.35it/s] 20%|█▉        | 46/234 [00:11<00:49,  3.76it/s] 20%|██        | 47/234 [00:11<00:47,  3.90it/s] 21%|██        | 48/234 [00:11<00:46,  4.04it/s] 21%|██        | 49/234 [00:11<00:45,  4.11it/s] 21%|██▏       | 50/234 [00:12<00:43,  4.22it/s] 22%|██▏       | 51/234 [00:12<00:42,  4.32it/s] 22%|██▏       | 52/234 [00:12<00:41,  4.37it/s] 23%|██▎       | 53/234 [00:12<00:41,  4.38it/s] 23%|██▎       | 54/234 [00:13<00:41,  4.37it/s] 24%|██▎       | 55/234 [00:13<00:40,  4.39it/s] 24%|██▍       | 56/234 [00:13<00:41,  4.32it/s] 24%|██▍       | 57/234 [00:13<00:40,  4.39it/s] 25%|██▍       | 58/234 [00:13<00:40,  4.39it/s] 25%|██▌       | 59/234 [00:14<00:39,  4.41it/s] 26%|██▌       | 60/234 [00:14<00:39,  4.44it/s] 26%|██▌       | 61/234 [00:14<00:38,  4.47it/s] 26%|██▋       | 62/234 [00:14<00:38,  4.47it/s] 27%|██▋       | 63/234 [00:15<00:38,  4.44it/s] 27%|██▋       | 64/234 [00:15<00:38,  4.41it/s] 28%|██▊       | 65/234 [00:15<00:38,  4.39it/s] 28%|██▊       | 66/234 [00:15<00:38,  4.41it/s] 29%|██▊       | 67/234 [00:15<00:37,  4.40it/s] 29%|██▉       | 68/234 [00:16<00:37,  4.43it/s] 29%|██▉       | 69/234 [00:16<00:37,  4.38it/s] 30%|██▉       | 70/234 [00:16<00:36,  4.44it/s] 30%|███       | 71/234 [00:16<00:36,  4.43it/s] 31%|███       | 72/234 [00:17<00:36,  4.38it/s] 31%|███       | 73/234 [00:17<00:37,  4.27it/s] 32%|███▏      | 74/234 [00:17<00:36,  4.34it/s] 32%|███▏      | 75/234 [00:17<00:36,  4.37it/s] 32%|███▏      | 76/234 [00:18<00:36,  4.33it/s] 33%|███▎      | 77/234 [00:18<00:35,  4.39it/s] 33%|███▎      | 78/234 [00:18<00:31,  4.89it/s] 34%|███▍      | 79/234 [00:18<00:32,  4.77it/s] 34%|███▍      | 80/234 [00:18<00:32,  4.70it/s] 35%|███▍      | 81/234 [00:19<00:33,  4.54it/s] 35%|███▌      | 82/234 [00:19<00:33,  4.48it/s] 35%|███▌      | 83/234 [00:19<00:33,  4.49it/s] 36%|███▌      | 84/234 [00:19<00:33,  4.54it/s] 36%|███▋      | 85/234 [00:19<00:32,  4.55it/s] 37%|███▋      | 86/234 [00:20<00:33,  4.44it/s] 37%|███▋      | 87/234 [00:20<00:32,  4.47it/s] 38%|███▊      | 88/234 [00:20<00:32,  4.47it/s] 38%|███▊      | 89/234 [00:20<00:32,  4.45it/s] 38%|███▊      | 90/234 [00:21<00:32,  4.38it/s] 39%|███▉      | 91/234 [00:21<00:32,  4.37it/s] 39%|███▉      | 92/234 [00:21<00:32,  4.34it/s] 40%|███▉      | 93/234 [00:21<00:31,  4.41it/s] 40%|████      | 94/234 [00:22<00:31,  4.44it/s] 41%|████      | 95/234 [00:22<00:31,  4.38it/s] 41%|████      | 96/234 [00:22<00:31,  4.41it/s] 41%|████▏     | 97/234 [00:22<00:30,  4.44it/s] 42%|████▏     | 98/234 [00:22<00:30,  4.45it/s] 42%|████▏     | 99/234 [00:23<00:30,  4.46it/s] 43%|████▎     | 100/234 [00:23<00:31,  4.25it/s]                                                 {'loss': 5.8223, 'grad_norm': 12.399885177612305, 'learning_rate': 5.64e-06, 'epoch': 1.28}
 43%|████▎     | 100/234 [00:23<00:31,  4.25it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 25%|██▌       | 2/8 [00:01<00:05,  1.13it/s][A
 38%|███▊      | 3/8 [00:03<00:05,  1.12s/it][A
 50%|█████     | 4/8 [00:04<00:05,  1.34s/it][A
 62%|██████▎   | 5/8 [00:06<00:04,  1.45s/it][A
 75%|███████▌  | 6/8 [00:08<00:03,  1.60s/it][A
 88%|████████▊ | 7/8 [00:11<00:02,  2.09s/it][A
100%|██████████| 8/8 [00:12<00:00,  1.86s/it][A[1] 预测: 过了 a few minutes, he breathed a sigh of relief, and put his hands together on the table.
    标签: ['After a few seconds, he coughed and folded his olive-skin hands on the table.']
[2] 预测: I can spend a night a night in my apartment, and I have to deal with almost no-one's time.
    标签: ['I could spend evening after evening cooped up in my flat, and I was often faced with weekends that offered little or nothing in the way of company.']
[3] 预测: 中生代中晚期 the regional heat event is central to the regional heat formation.
    标签: ['The regional tectonicthermal events in the MidLate Mesozoic were the crucial factors controlling the regional high thermal evolution of the Paleozoic in TaikangJiyuan area.']
[4] 预测: We have not left before, our feet have not moved your way.
    标签: ['Our hearts had not turned back; our feet had not strayed from your path.']
[5] 预测: He pushed the horse, to get the fastest way.
    标签: ['He switched his horse to make it go faster .']
                                                 
                                             [A{'eval_loss': 4.4719414710998535, 'eval_model_preparation_time': 0.0047, 'eval_bleu': 6.2549, 'eval_gen_len': 25.904, 'eval_runtime': 14.3837, 'eval_samples_per_second': 34.762, 'eval_steps_per_second': 0.556, 'epoch': 1.28}
 43%|████▎     | 100/234 [00:37<00:31,  4.25it/s]
100%|██████████| 8/8 [00:13<00:00,  1.86s/it][A
                                             [A 43%|████▎     | 101/234 [00:38<10:05,  4.55s/it] 44%|████▎     | 102/234 [00:38<07:10,  3.26s/it] 44%|████▍     | 103/234 [00:38<05:08,  2.35s/it] 44%|████▍     | 104/234 [00:38<03:42,  1.71s/it] 45%|████▍     | 105/234 [00:38<02:43,  1.27s/it] 45%|████▌     | 106/234 [00:39<02:02,  1.05it/s] 46%|████▌     | 107/234 [00:39<01:33,  1.36it/s] 46%|████▌     | 108/234 [00:39<01:13,  1.71it/s] 47%|████▋     | 109/234 [00:39<00:59,  2.10it/s] 47%|████▋     | 110/234 [00:40<00:50,  2.44it/s] 47%|████▋     | 111/234 [00:40<00:44,  2.76it/s] 48%|████▊     | 112/234 [00:40<00:38,  3.14it/s] 48%|████▊     | 113/234 [00:40<00:35,  3.40it/s] 49%|████▊     | 114/234 [00:41<00:32,  3.70it/s] 49%|████▉     | 115/234 [00:41<00:30,  3.86it/s] 50%|████▉     | 116/234 [00:41<00:29,  4.04it/s] 50%|█████     | 117/234 [00:41<00:28,  4.14it/s] 50%|█████     | 118/234 [00:41<00:27,  4.26it/s] 51%|█████     | 119/234 [00:42<00:26,  4.32it/s] 51%|█████▏    | 120/234 [00:42<00:26,  4.26it/s] 52%|█████▏    | 121/234 [00:42<00:26,  4.22it/s] 52%|█████▏    | 122/234 [00:42<00:26,  4.30it/s] 53%|█████▎    | 123/234 [00:43<00:25,  4.35it/s] 53%|█████▎    | 124/234 [00:43<00:24,  4.41it/s] 53%|█████▎    | 125/234 [00:43<00:24,  4.37it/s] 54%|█████▍    | 126/234 [00:43<00:24,  4.41it/s] 54%|█████▍    | 127/234 [00:43<00:23,  4.48it/s] 55%|█████▍    | 128/234 [00:44<00:24,  4.40it/s] 55%|█████▌    | 129/234 [00:44<00:23,  4.44it/s] 56%|█████▌    | 130/234 [00:44<00:23,  4.46it/s] 56%|█████▌    | 131/234 [00:44<00:23,  4.47it/s] 56%|█████▋    | 132/234 [00:45<00:23,  4.43it/s] 57%|█████▋    | 133/234 [00:45<00:24,  4.19it/s] 57%|█████▋    | 134/234 [00:45<00:23,  4.27it/s] 58%|█████▊    | 135/234 [00:45<00:23,  4.21it/s] 58%|█████▊    | 136/234 [00:46<00:24,  4.04it/s] 59%|█████▊    | 137/234 [00:46<00:23,  4.18it/s] 59%|█████▉    | 138/234 [00:46<00:23,  4.16it/s] 59%|█████▉    | 139/234 [00:46<00:22,  4.27it/s] 60%|█████▉    | 140/234 [00:47<00:21,  4.35it/s] 60%|██████    | 141/234 [00:47<00:21,  4.40it/s] 61%|██████    | 142/234 [00:47<00:20,  4.42it/s] 61%|██████    | 143/234 [00:47<00:20,  4.51it/s] 62%|██████▏   | 144/234 [00:47<00:20,  4.32it/s] 62%|██████▏   | 145/234 [00:48<00:20,  4.38it/s] 62%|██████▏   | 146/234 [00:48<00:19,  4.46it/s] 63%|██████▎   | 147/234 [00:48<00:19,  4.42it/s] 63%|██████▎   | 148/234 [00:48<00:19,  4.44it/s] 64%|██████▎   | 149/234 [00:49<00:18,  4.49it/s] 64%|██████▍   | 150/234 [00:49<00:18,  4.50it/s] 65%|██████▍   | 151/234 [00:49<00:18,  4.54it/s] 65%|██████▍   | 152/234 [00:49<00:18,  4.49it/s] 65%|██████▌   | 153/234 [00:49<00:18,  4.38it/s] 66%|██████▌   | 154/234 [00:50<00:18,  4.33it/s] 66%|██████▌   | 155/234 [00:50<00:18,  4.34it/s] 67%|██████▋   | 156/234 [00:50<00:16,  4.83it/s] 67%|██████▋   | 157/234 [00:50<00:16,  4.75it/s] 68%|██████▊   | 158/234 [00:51<00:16,  4.68it/s] 68%|██████▊   | 159/234 [00:51<00:16,  4.66it/s] 68%|██████▊   | 160/234 [00:51<00:16,  4.59it/s] 69%|██████▉   | 161/234 [00:51<00:15,  4.62it/s] 69%|██████▉   | 162/234 [00:51<00:15,  4.60it/s] 70%|██████▉   | 163/234 [00:52<00:15,  4.63it/s] 70%|███████   | 164/234 [00:52<00:15,  4.63it/s] 71%|███████   | 165/234 [00:52<00:14,  4.60it/s] 71%|███████   | 166/234 [00:52<00:15,  4.38it/s] 71%|███████▏  | 167/234 [00:53<00:15,  4.45it/s] 72%|███████▏  | 168/234 [00:53<00:14,  4.42it/s] 72%|███████▏  | 169/234 [00:53<00:14,  4.44it/s] 73%|███████▎  | 170/234 [00:53<00:14,  4.41it/s] 73%|███████▎  | 171/234 [00:53<00:14,  4.49it/s] 74%|███████▎  | 172/234 [00:54<00:14,  4.40it/s] 74%|███████▍  | 173/234 [00:54<00:13,  4.47it/s] 74%|███████▍  | 174/234 [00:54<00:13,  4.48it/s] 75%|███████▍  | 175/234 [00:54<00:13,  4.45it/s] 75%|███████▌  | 176/234 [00:55<00:12,  4.48it/s] 76%|███████▌  | 177/234 [00:55<00:12,  4.50it/s] 76%|███████▌  | 178/234 [00:55<00:12,  4.37it/s] 76%|███████▋  | 179/234 [00:55<00:12,  4.39it/s] 77%|███████▋  | 180/234 [00:55<00:12,  4.26it/s] 77%|███████▋  | 181/234 [00:56<00:12,  4.34it/s] 78%|███████▊  | 182/234 [00:56<00:12,  4.31it/s] 78%|███████▊  | 183/234 [00:56<00:11,  4.38it/s] 79%|███████▊  | 184/234 [00:56<00:11,  4.42it/s] 79%|███████▉  | 185/234 [00:57<00:11,  4.38it/s] 79%|███████▉  | 186/234 [00:57<00:10,  4.41it/s] 80%|███████▉  | 187/234 [00:57<00:10,  4.39it/s] 80%|████████  | 188/234 [00:57<00:10,  4.39it/s] 81%|████████  | 189/234 [00:58<00:10,  4.36it/s] 81%|████████  | 190/234 [00:58<00:10,  4.21it/s] 82%|████████▏ | 191/234 [00:58<00:10,  4.20it/s] 82%|████████▏ | 192/234 [00:58<00:09,  4.32it/s] 82%|████████▏ | 193/234 [00:58<00:09,  4.34it/s] 83%|████████▎ | 194/234 [00:59<00:09,  4.41it/s] 83%|████████▎ | 195/234 [00:59<00:08,  4.51it/s] 84%|████████▍ | 196/234 [00:59<00:08,  4.39it/s] 84%|████████▍ | 197/234 [00:59<00:08,  4.42it/s] 85%|████████▍ | 198/234 [01:00<00:08,  4.50it/s] 85%|████████▌ | 199/234 [01:00<00:08,  4.37it/s] 85%|████████▌ | 200/234 [01:00<00:07,  4.41it/s]                                                 {'loss': 4.2481, 'grad_norm': 8.48436164855957, 'learning_rate': 1.164e-05, 'epoch': 2.56}
 85%|████████▌ | 200/234 [01:00<00:07,  4.41it/s]
  0%|          | 0/8 [00:00<?, ?it/s][A
 25%|██▌       | 2/8 [00:03<00:09,  1.59s/it][A
 38%|███▊      | 3/8 [00:04<00:08,  1.64s/it][A
 50%|█████     | 4/8 [00:07<00:08,  2.01s/it][A
 62%|██████▎   | 5/8 [00:11<00:07,  2.53s/it][A
 75%|███████▌  | 6/8 [00:13<00:04,  2.43s/it][A
 88%|████████▊ | 7/8 [00:17<00:03,  3.04s/it][A
100%|██████████| 8/8 [00:24<00:00,  4.25s/it][A[1] 预测: After a few minutes, he breathed a sigh of relief, and folded his hands together on the desk.
    标签: ['After a few seconds, he coughed and folded his olive-skin hands on the table.']
[2] 预测: I can spend a night a night in my apartment, and I have to deal with almost no time for the weekend.
    标签: ['I could spend evening after evening cooped up in my flat, and I was often faced with weekends that offered little or nothing in the way of company.']
[3] 预测: The regionization of heat events in the middle-after-century is a key factor in the development of the central-anthropogenic high heat events.
    标签: ['The regional tectonicthermal events in the MidLate Mesozoic were the crucial factors controlling the regional high thermal evolution of the Paleozoic in TaikangJiyuan area.']
[4] 预测: We have not left before, and our feet have not moved away from your path.
    标签: ['Our hearts had not turned back; our feet had not strayed from your path.']
[5] 预测: He stabbed the horse, to get him to the fastest speed.
    标签: ['He switched his horse to make it go faster .']
                                                 
                                             [A{'eval_loss': 3.432405710220337, 'eval_model_preparation_time': 0.0047, 'eval_bleu': 10.7607, 'eval_gen_len': 29.986, 'eval_runtime': 26.206, 'eval_samples_per_second': 19.08, 'eval_steps_per_second': 0.305, 'epoch': 2.56}
 85%|████████▌ | 200/234 [01:26<00:07,  4.41it/s]
100%|██████████| 8/8 [00:24<00:00,  4.25s/it][A
                                             [A 86%|████████▌ | 201/234 [01:26<04:27,  8.09s/it] 86%|████████▋ | 202/234 [01:27<03:03,  5.74s/it] 87%|████████▋ | 203/234 [01:27<02:06,  4.09s/it] 87%|████████▋ | 204/234 [01:27<01:27,  2.93s/it] 88%|████████▊ | 205/234 [01:27<01:01,  2.12s/it] 88%|████████▊ | 206/234 [01:28<00:43,  1.55s/it] 88%|████████▊ | 207/234 [01:28<00:31,  1.17s/it] 89%|████████▉ | 208/234 [01:28<00:23,  1.12it/s] 89%|████████▉ | 209/234 [01:28<00:17,  1.45it/s] 90%|████████▉ | 210/234 [01:29<00:13,  1.77it/s] 90%|█████████ | 211/234 [01:29<00:10,  2.18it/s] 91%|█████████ | 212/234 [01:29<00:08,  2.55it/s] 91%|█████████ | 213/234 [01:29<00:07,  2.94it/s] 91%|█████████▏| 214/234 [01:30<00:06,  3.27it/s] 92%|█████████▏| 215/234 [01:30<00:05,  3.56it/s] 92%|█████████▏| 216/234 [01:30<00:04,  3.79it/s] 93%|█████████▎| 217/234 [01:30<00:04,  3.99it/s] 93%|█████████▎| 218/234 [01:30<00:04,  3.98it/s] 94%|█████████▎| 219/234 [01:31<00:03,  4.05it/s] 94%|█████████▍| 220/234 [01:31<00:03,  4.17it/s] 94%|█████████▍| 221/234 [01:31<00:03,  4.17it/s] 95%|█████████▍| 222/234 [01:31<00:02,  4.28it/s] 95%|█████████▌| 223/234 [01:32<00:02,  4.30it/s] 96%|█████████▌| 224/234 [01:32<00:02,  3.92it/s] 96%|█████████▌| 225/234 [01:32<00:02,  4.04it/s] 97%|█████████▋| 226/234 [01:32<00:01,  4.08it/s] 97%|█████████▋| 227/234 [01:33<00:01,  4.15it/s] 97%|█████████▋| 228/234 [01:33<00:01,  4.01it/s] 98%|█████████▊| 229/234 [01:33<00:01,  4.13it/s] 98%|█████████▊| 230/234 [01:33<00:00,  4.14it/s] 99%|█████████▊| 231/234 [01:34<00:00,  4.26it/s] 99%|█████████▉| 232/234 [01:34<00:00,  4.29it/s]100%|█████████▉| 233/234 [01:34<00:00,  4.37it/s]100%|██████████| 234/234 [01:34<00:00,  4.88it/s]/root/miniconda3/lib/python3.12/site-packages/transformers/modeling_utils.py:3685: UserWarning: Moving the following attributes in the config to the generation config: {'max_length': 200, 'early_stopping': True, 'num_beams': 5}. You are seeing this warning because you've set generation parameters in the model config, as opposed to in the generation config.
  warnings.warn(
Traceback (most recent call last):
  File "/root/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 850, in save
    _save(
  File "/root/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 1114, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:778] . PytorchStreamWriter failed writing file data/557: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/root/final/code/translation_trainer_7.py", line 546, in <module>
    main()
  File "/root/final/code/translation_trainer_7.py", line 535, in main
    scale_law_for_mbart_model(datasets)
  File "/root/final/code/translation_trainer_7.py", line 460, in scale_law_for_mbart_model
    output_dir = train_mbart_model(
                 ^^^^^^^^^^^^^^^^^^
  File "/root/final/code/translation_trainer_7.py", line 444, in train_mbart_model
    mbart_trainer.train(small_datasets, output_dir=output_dir, epochs=3, batch_size=64)
  File "/root/final/code/translation_trainer_7.py", line 369, in train
    trainer.train()
  File "/root/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2207, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2624, in _inner_training_loop
    self._maybe_log_save_evaluate(
  File "/root/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3104, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial)
  File "/root/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3212, in _save_checkpoint
    self._save_optimizer_and_scheduler(output_dir)
  File "/root/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3339, in _save_optimizer_and_scheduler
    torch.save(self.optimizer.state_dict(), os.path.join(output_dir, OPTIMIZER_NAME))
  File "/root/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 849, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/root/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 690, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:603] . unexpected pos 4487395968 vs 4487395864
100%|██████████| 234/234 [02:01<00:00,  1.92it/s]
