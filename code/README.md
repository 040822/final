# 英译中神经网络翻译系统

## 项目概述

这是一个基于Transformer架构的英译中神经网络翻译系统，使用PyTorch实现。系统包含完整的数据预处理、模型训练、推理和评估功能。

## 核心思路

### 1. 模型架构
- **Transformer模型**: 使用经典的Encoder-Decoder架构
- **多头注意力**: 8个注意力头，提高模型表达能力
- **位置编码**: 正弦余弦位置编码，处理序列位置信息
- **残差连接**: 每个子层都有残差连接和层归一化

### 2. 数据处理
- **英文预处理**: 小写化、分词、构建词汇表
- **中文预处理**: 使用jieba分词，构建字符级词汇表
- **特殊符号**: 支持`<pad>`, `<unk>`, `<sos>`, `<eos>`
- **动态填充**: 批处理时自动填充到相同长度

### 3. 训练策略
- **AdamW优化器**: 带权重衰减的Adam优化器
- **学习率调度**: 基于验证损失的自适应调度
- **梯度裁剪**: 防止梯度爆炸
- **早停机制**: 防止过拟合

## 文件结构

```
code/
├── dataset.py          # 数据加载和预处理
├── model.py           # Transformer模型实现
├── train.py           # 训练脚本
├── inference.py       # 推理脚本
├── requirements.txt   # 依赖包
├── README.md         # 使用说明
└── data/
    ├── translation2019zh_train.json
    └── translation2019zh_valid.json
```

## 使用方法

### 1. 环境设置

```bash
# 安装依赖
pip install -r requirements.txt

# 确保有足够的GPU内存（建议8GB以上）
```

### 2. 数据预处理

数据集已经是JSON格式，每行包含一个英译中的句子对：
```json
{"english": "This is a sample sentence.", "chinese": "这是一个示例句子。"}
```

### 3. 训练模型

```bash
python train.py
```

训练参数：
- **批大小**: 16（可根据GPU内存调整）
- **学习率**: 1e-4
- **最大序列长度**: 128
- **训练轮数**: 20轮
- **模型维度**: 512

### 4. 推理翻译

```bash
python inference.py
```

支持两种模式：
- **交互式翻译**: 输入英文句子，实时翻译
- **文件翻译**: 批量翻译文件

### 5. 监控训练

```bash
tensorboard --logdir=logs
```

可以在浏览器中查看训练损失曲线。

## 模型性能

### 预期性能指标
- **参数量**: ~65M参数
- **训练时间**: 在RTX 3080上约8-12小时
- **推理速度**: 每句约0.1-0.3秒
- **内存需求**: 训练时约6-8GB GPU内存

### 性能优化建议
1. **数据增强**: 可以添加回译、同义词替换等技术
2. **模型集成**: 训练多个模型进行集成
3. **束搜索**: 使用束搜索替代贪婪搜索
4. **预训练**: 使用预训练的多语言模型

## 技术细节

### 1. 注意力机制
- **编码器自注意力**: 学习源语言内部依赖关系
- **解码器自注意力**: 学习目标语言内部依赖关系
- **交叉注意力**: 学习源语言和目标语言的对齐关系

### 2. 掩码机制
- **填充掩码**: 忽略填充符号的注意力
- **前瞻掩码**: 防止解码器看到未来的信息

### 3. 损失函数
- **交叉熵损失**: 标准的语言模型损失
- **标签平滑**: 可选的正则化技术

## 可能的改进方向

1. **数据质量**: 清理数据，移除噪声样本
2. **模型架构**: 尝试不同的Transformer变体
3. **训练技巧**: 使用更先进的训练技术
4. **多模态**: 结合图像等其他模态信息
5. **领域适应**: 针对特定领域进行微调

## 常见问题

### Q: 训练时GPU内存不足
A: 减少batch_size，或使用梯度累积技术

### Q: 翻译质量不佳
A: 检查数据质量，增加训练时间，调整超参数

### Q: 训练速度慢
A: 使用更强的GPU，或使用混合精度训练

### Q: 如何评估模型性能
A: 使用BLEU、ROUGE等自动评估指标，或人工评估

## 注意事项

1. 确保训练数据的质量和多样性
2. 定期保存模型检查点
3. 监控训练过程，避免过拟合
4. 根据实际需求调整模型大小和复杂度
5. 考虑使用预训练模型进行迁移学习

## 联系方式

如有问题，请参考PyTorch官方文档或相关论文。
